{"version":3,"sources":["../src/index.js"],"names":["stringToMap","string","_ref","arguments","length","undefined","_ref$separator","separator","_ref$operator","operator","map","itemsArr","split","forEach","element","keyValue","decodeURIComponent","e","getCookieAsMap","document","cookie","tmsso","engsso","addHours","date","hours","SyntaxError","isNaN","parseInt","TypeError","result","Date","setHours","getHours","addDays","days","setDate","getDate","debounce","func","wait","immediate","timeout","debounced","context","args","later","apply","callNow","clearTimeout","setTimeout","getBreakpoint","breakpoint","windowWidth","window","innerWidth","documentElement","clientWidth","body","breakpoints","xs","xxs","s","m","l","xl","xxl","getBreakpointName","resultBreakpoint","arraysEqual","a","b","Array","isArray","i","version","_classCallCheck","instance","Constructor","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","_toConsumableArray","arr","arr2","from","ssoKey","location","hostname","indexOf","dfpBaseConf","JSON","parse","getElementById","textContent","err","dfpConfig","assign","referrer","isMobile","test","navigator","userAgent","isHomepage","pathname","environment","department","domain","regexMatch","exec","path","sectionArray","articleId","slice","filter","section","index","reduce","last","current","concat","site","env","dev","prod","port","articleIdMatch","pop","utm_","content","getUrlParam","source","medium","campaign","results","RegExp","search","adBlockRemoved","localStorage","getItem","ssoGroupKey","anonymousId","cookieName","cookieMap","isWriterAlerts","wifiLocation","toLowerCase","isValidForsmartPhone","validForAds","PageUrl","href","isSmartphoneapp","match","NotPayer","HtzPusr","gStatCampaignNumber","gstatCampaign","CampaignNumber","proposalNumber","proposal","adSlotConfig","id","responsive","adSizeMapping","priority","fluid","responsiveAdSizeMapping","blacklistReferrers","whitelistReferrers","adManagerConfig","network","adUnitBase","breakpointsConfig","googleGlobalSettings","breakpointType","breakpoints1","breakpoints2","breakpoints3","breakpoints4","userConfig","type","age","gender","conflictManagementConfig","onsize","avoid","impressionManagerConfig","frequency","exposed","expires","getTime","enableSingleRequest","enableAsyncRendering","refreshIntervalTime","sso","keys","impressions","frequencyRegex","maxImpressions","adSlotId","ImpressionsManager","now","config","retrieveImpressionsData","initImpressionMap","value","_this","migrateImpressionsData","hasOwnProperty","call","_this2","impressionsData","oldImpressionsArray","impression","adUnitImpression","name","data","tmp","slotId","join","err1","saveImpressionsToLocalStorage","debouncedSave","saveImpressionsToLocalStorageImpl","setItem","stringify","console","error","_this3","slot","shouldUpdateExpiryDate","initSlotFromConfig","updateExpiryDate","slotName","Error","frequencyMap","setMilliseconds","setSeconds","setMinutes","registerImpression","reachedQuota","atQuota","resetImpressions","userTypes","payer","registered","anonymous","trial","productTypes","htz","tm","hdc","htz_tm","User","getUserType","htz_type","getUserTypeByProduct","tm_type","hdc_type","impressionManager","getUserAge","getUserGender","getUserSSO","userType","payerProp","productType","userProducts","getHdcUserType","getHtzTmUserType","userHasProduct","products","product","prodNum","usrae","urgdr","ssoKey$$1","ConflictResolver","dependencyMap","initializeDependencyMap","deferredSlots","Set","conflictManagementJson","queue","Map","rules","item","set","resolvedWith","updateResolvedSlot","resolvedSize","has","get","isBlocked","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","Symbol","iterator","_step","next","done","adSlotKey","adSlot","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","adSlotRule","parentResolvedWith","add","find","sizeString","size","numberStr","return","isBlocking","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3","getBlockedSlotsIds","EMPTY_SIZE","hiddenClass","user","adManager","htmlElement","deferredSlot","lastResolvedSize","lastResolvedWithBreakpoint","defineSlot","isOutOfPage","adTypes","maavaron","popunder","talkback","regular","isMaavaron","isWhitelisted","whitelisted","isBlacklisted","blacklisted","show","shown","googletag","cmd","push","classList","remove","display","hide","maavaronSlot","defineMaavaron","shouldSendRequestToDfp","pubads","defineFn","defineOutOfPageSlot","getPath","responsiveSlotSizeMapping","sizeMapping","addSize","build","defineSizeMapping","addService","setCollapseEmptyDiv","calculatedPath","slotRendered","event","getAdUnitPath","isEmpty","refresh","_this4","adUnitMaavaronPath","adUnitMaavaronSize","definePassback","setTargeting","adPriorities","high","normal","low","adTargets","all","nonPaying","paying","digitalOnly","digitalAndPrint","userTypes$1","AdManager","conflictResolver","initGoogleTargetingParams","initGoogleGlobalSettings","initSlotRenderedCallback","currentBreakpointName","adSlots","initAdSlots","onDomLoaded","log","onWindowLoaded","blockingAdSlotKey","delete","showAllDeferredSlots","readyState","addEventListener","showAllSlots","adSlot$$1","getAdSlotsByPriority","priorityFilter","values","deferredSlotId","deferredAdSlot","refreshAllSlots","currentBreakpoint","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_iterator4","_step4","refreshAllSlotsInPage","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_iterator5","_step5","refreshSlot","adUnitName","filteredPriority","adSlotPlaceholders","getElementsByClassName","node","adSlotNodeSet","adSlotPriority","computedAdSlotConfig","attributes","getAdType","adSlotInstance","isPriority","shouldDisplayAdAfterAdBlockRemoval","shouldDisplayAdMaavaronAfterPayWallBanner","doesBreakpointContainAd","haveValidCookieForSmartphoneapp","doesUserTypeMatchBannerTargeting","shouldDisplay","paywallBanner","mc","nextslotLocation","includes","adSlotOrTarget","adTarget","switchedToBreakpoint","count","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_iterator6","_step6","containsBreakpoint","mapping","apiReady","releaseSlotDependencies","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_iterator7","_step7","blockedSlot","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_iterator8","_step8","deferredSlotKey","tags","anonymousIdKeyName","setCentering","enableSyncRendering","enableServices","defaultConfig","resizeTimeout","DFP","wasInitialized","initStarted","initWindowResizeListener","resumeInit","initGoogleTag","dfpThis","Promise","resolve","reject","tag","createElement","async","setAttribute","getElementsByTagName","parentNode","insertBefore","isGoogleTagReady","onResize","debouncedFunction","onresize","version$1"],"mappings":"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","file":"dfp.js","sourcesContent":["import { version } from 'package.json';\n\nvar _classCallCheck = (function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n});\n\nvar _createClass = (function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n})();\n\nvar _toConsumableArray = (function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }return arr2;\n  } else {\n    return Array.from(arr);\n  }\n});\n\n/**\n * Htz-cookie-util\n * @module htzCookieUtil\n * @author Elia Grady elia.grady@haaretz.co.il\n * @license MIT\n */\n\n/**\n * Translates Key-Value string into a convenient map.\n * @param {String} string String in format of \"key<operator>value<separator>.....\"\n * @param {object} options object for overriding defaults:\n * options.separator is a String or regExp that separates between each key value pairs\n * (default is ';'). options.operator is a String or regExp that separates between each key\n * and value within a pair (default is '=').\n * @returns {object} a map object, with key-value mapping according to the passed configuration.\n */\nfunction stringToMap(string) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref$separator = _ref.separator,\n      separator = _ref$separator === undefined ? ';' : _ref$separator,\n      _ref$operator = _ref.operator,\n      operator = _ref$operator === undefined ? '=' : _ref$operator;\n\n  var map = {};\n  var itemsArr = string.split(separator);\n  itemsArr.forEach(function (element) {\n    if (typeof element === 'string') {\n      var keyValue = element.split(operator);\n      if (keyValue.length === 2) {\n        try {\n          map[keyValue[0]] = decodeURIComponent(keyValue[1]);\n        } catch (e) {\n          // Do nothing, malformed URI\n        }\n      }\n    }\n  });\n  return map;\n}\nvar ssoKey = window.location.hostname.indexOf('haaretz.com') > -1 ? 'engsso' : 'tmsso';\n\n// Translates Cookie string into a convenient map.\nfunction getCookieAsMap() {\n  var map = stringToMap(document.cookie, { separator: /;\\s?/ });\n  if (typeof map.tmsso === 'string') {\n    map.tmsso = stringToMap(map.tmsso, { separator: ':' });\n  }\n  if (typeof map.engsso === 'string') {\n    map.engsso = stringToMap(map.engsso, { separator: ':' });\n  }\n  return map;\n}\n\n/* global dfpConfig */\n// globalConfig for DFP\nvar dfpBaseConf = void 0;\ntry {\n  dfpBaseConf = window.JSON.parse(document.getElementById('dfpConfig').textContent);\n} catch (err) {\n  dfpBaseConf = window.dfpConfig;\n}\nvar dfpConfig = Object.assign({\n  get referrer() {\n    return document.referrer ? document.referrer : '';\n  },\n  get isMobile() {\n    return (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent || '')\n    );\n  },\n  /**\n   * Returns true iff the loaded page is the homepage (no inner path)\n   * @returns {boolean}\n   */\n  get isHomepage() {\n    return window.location.pathname === '/' || this.environment === 3; // 'prod'\n  },\n  get department() {\n    return this.isHomepage ? '_homepage' : '_section';\n  },\n  /**\n   * returns the domain the page was loaded to. i.e: 'haaretz.co.il', 'haaretz.com'\n   * @returns {string} the domain name from the windows's location hostname property\n   */\n  get domain() {\n    var regexMatch = /([\\d|\\w]+)(\\.co\\.il|\\.com)(.*)?/.exec(window.location.hostname);\n    var result = regexMatch ? regexMatch[0] : window.location.hostname;\n    return result;\n  },\n  /**\n   * Returns an array of concatenated paths, separated by a dot.\n   * For example, for the URL:\n   * http://www.haaretz.co.il/news/world/america/us-election-2016/LIVE-1.2869045\n   * the path is '/news/world/america/us-election-2016/LIVE-1.2869045'.\n   * This function takes the directories ['news', 'world', 'america', 'us-election-2016']\n   * and converts it to the following format:\n   * ['.news', '.news.world', '.news.world.america', '.news.world.america.us-election-2016']\n   * This denotes the path configuration for the given adSlot\n   * non articles (sections) will be given a '0' - no articleId value for targeting purposes)\n   * @returns {Array.<T>} an array of path names\n   */\n  get path() {\n    var sectionArray = this.articleId && this.articleId !== '0' ? window.location.pathname.split('/').slice(1, -1) : window.location.pathname.split('/').slice(1);\n    sectionArray = sectionArray.filter(function (path) {\n      return path !== 'wwwMobileSite' && path !== 'whtzMobileSite';\n    });\n    return sectionArray.map(function (section) {\n      return '.' + section;\n    }).map(function (section, index, arr) {\n      return arr.slice(0, index + 1).reduce(function (last, current) {\n        return last.concat(current);\n      });\n    });\n  },\n  /**\n   * Returns a string representation for the name of the site\n   * @return {*|string}\n   */\n  get site() {\n    var site = void 0;\n    if (window.location.hostname.indexOf('haaretz.co.il') > -1) {\n      site = 'haaretz';\n    } else if (window.location.hostname.indexOf('themarker.com') > -1) {\n      site = 'themarker';\n    } else if (window.location.hostname.indexOf('mouse.co.il') > -1) {\n      site = 'mouse';\n    }\n    return site || 'haaretz';\n  },\n  /**\n   * Returns the current environment targeting param, if such is defined.\n   * @returns {number} targeting param, 1 for local development, 2 for test servers and 3 for prod.\n   * May return undefined if no targeting is specified.\n   */\n  get environment() {\n    var env = {\n      dev: 1,\n      test: 2,\n      prod: 3\n    };\n    return window.location.port === '8080' ? env.dev : window.location.hostname.indexOf('pre.haaretz.co.il') > -1 || window.location.hostname.indexOf('tmtest.themarker.com') > -1 || window.location.hostname.indexOf('pre.haaretz.com') > -1 || window.location.hostname.indexOf('prodmouse.mouse.co.il') > -1 ? env.test : window.location.pathname.indexOf('/cmlink/Haaretz.HomePage') > -1 || window.location.pathname.indexOf('/cmlink/TheMarker.HomePage') > -1 || window.location.pathname.indexOf('/cmlink/Mouse.HomePage') > -1 ? env.prod : undefined;\n  },\n  /**\n   * Returns the articleIf if on an article page, or null otherwise\n   * @returns {string} an articleId string from the pathname, or 0 if not found\n   */\n  get articleId() {\n    var articleIdMatch = /\\d\\.\\d+/g.exec(window.location.pathname);\n    var articleId = '0';\n    if (articleIdMatch) {\n      articleId = articleIdMatch.pop(); // Converts [\"1.23145\"] to \"1.23145\"\n    }\n    return articleId;\n  },\n  utm_: {\n    get content() {\n      return this.getUrlParam('utm_content');\n    },\n    get source() {\n      return this.getUrlParam('utm_source');\n    },\n    get medium() {\n      return this.getUrlParam('utm_medium');\n    },\n    get campaign() {\n      return this.getUrlParam('utm_campaign');\n    },\n    getUrlParam: function getUrlParam(key) {\n      var results = RegExp('(' + key + ')(=)([^&\"]+)').exec(window.location.search);\n      return results && results[3] ? results[3] : undefined;\n    }\n  },\n  get adBlockRemoved() {\n    var adBlockRemoved = false;\n    try {\n      if (localStorage.getItem('adblock_removed')) {\n        adBlockRemoved = true;\n      }\n    } catch (err) {\n      // do nothing\n    }\n    return adBlockRemoved;\n  },\n  get ssoGroupKey() {\n    return window.localStorage.getItem('_ssoGroupKey');\n  },\n  get anonymousId() {\n    var cookieName = 'anonymousId';\n    var cookieMap = getCookieAsMap();\n    var anonymousId = '';\n    if (cookieMap && cookieMap[cookieName]) {\n      anonymousId = cookieMap[cookieName];\n    }\n    return anonymousId;\n  },\n  get isWriterAlerts() {\n    return location.search.indexOf('writerAlerts=true') > -1;\n  },\n  get wifiLocation() {\n    var wifiLocation = void 0;\n    var cookieName = '_htzwif'; // eslint-disable-line no-underscore-dangle\n    var cookieMap = getCookieAsMap();\n    try {\n      if (cookieMap && cookieMap[cookieName]) {\n        if (cookieMap[cookieName].toLowerCase() === 'arcaffe') {\n          wifiLocation = 'ArCafe';\n        }\n        if (cookieMap[cookieName].toLowerCase() === 'university') {\n          wifiLocation = 'university';\n        }\n      }\n    } catch (err) {\n      // do nothing\n    }\n    return wifiLocation;\n  },\n  get isValidForsmartPhone() {\n    var validForAds = true;\n    var PageUrl = window.location.href;\n    var isSmartphoneapp = PageUrl.match('haaretzsmartphoneapp');\n    var cookieMap = getCookieAsMap();\n    try {\n      if (isSmartphoneapp) {\n        // eslint-disable-line no-underscore-dangle\n        if (!cookieMap || !(cookieMap.NotPayer || cookieMap.HtzPusr)) {\n          validForAds = false;\n        }\n      }\n    } catch (err) {\n      // do nothing\n    }\n    return validForAds;\n  },\n  get gStatCampaignNumber() {\n    var gstatCampaign = void 0;\n    try {\n      gstatCampaign = localStorage.getItem('GstatCampaign') ? JSON.parse(localStorage.getItem('GstatCampaign')) : undefined;\n    } catch (err) {\n      /* In case of thrown 'SecurityError' or 'QuotaExceededError',\n       the variable should be undefined */\n      gstatCampaign = undefined;\n    }\n    return gstatCampaign ? gstatCampaign.CampaignNumber : undefined;\n  },\n  get proposalNumber() {\n    var proposal = void 0;\n    try {\n      proposal = localStorage.getItem('proposaltype') ? localStorage.getItem('proposaltype') : undefined;\n    } catch (err) {\n      /* In case of thrown 'SecurityError' or 'QuotaExceededError',\n       the variable should be undefined */\n      proposal = undefined;\n    }\n    return proposal;\n  },\n  adSlotConfig: {\n    'haaretz.co.il.example.slot': {\n      id: 'slotId',\n      // path : \"/network/base/slotId/slotId_subsection\", Will be calculated from AdManager\n      responsive: true,\n      adSizeMapping: [['width1', 'height1']].concat(['widthN', 'heightN']),\n      priority: 'normal',\n      fluid: false,\n      responsiveAdSizeMapping: {\n        xxs: [['width1', 'height1']].concat(['widthN', 'heightN']),\n        xs: [['width1', 'height1']].concat(['widthN', 'heightN']),\n        s: [['width1', 'height1']].concat(['widthN', 'heightN']),\n        m: [['width1', 'height1']].concat(['widthN', 'heightN']),\n        l: [['width1', 'height1']].concat(['widthN', 'heightN']),\n        xl: [['width1', 'height1']].concat(['widthN', 'heightN']),\n        xxl: [['width1', 'height1']].concat(['widthN', 'heightN'])\n      },\n      blacklistReferrers: 'comma, delimited, blacklisted, referrer, list',\n      whitelistReferrers: 'comma, delimited, referrer, list'\n    }\n  },\n  adManagerConfig: {\n    network: '9401',\n    adUnitBase: 'haaretz.co.il_Web'\n  },\n  breakpointsConfig: {\n    get breakpoints() {\n      // Override in VM from backend to control this toggle.\n      var breakpoints = void 0;\n      switch (dfpConfig.googleGlobalSettings.breakpointType) {\n        case 'type1':\n          breakpoints = this.breakpoints1;break;\n        case 'type2':\n          breakpoints = this.breakpoints2;break;\n        case 'type3':\n          breakpoints = this.breakpoints3;break;\n        case 'type4':\n          breakpoints = this.breakpoints4;break;\n        default:\n          breakpoints = this.breakpoints1;\n      }\n      return breakpoints;\n    },\n    // Type 1\n    breakpoints1: {\n      xxs: 600,\n      xs: 761,\n      s: 993,\n      m: 1009,\n      l: 1291,\n      xl: 1600,\n      xxl: 1900\n    },\n    // Type 2\n    breakpoints2: {\n      xxs: 600,\n      xs: 1000,\n      s: 1150,\n      m: 1281,\n      l: 1600,\n      xl: 1920,\n      xxl: 1920\n    },\n    // Type 3\n    breakpoints3: {\n      xxs: 100,\n      xs: 480,\n      s: 600,\n      m: 768,\n      l: 1024,\n      xl: 1280,\n      xxl: 1900\n    },\n    // Type 4\n    breakpoints4: {\n      xxs: 600,\n      xs: 768,\n      s: 1024,\n      m: 1280,\n      l: 1900,\n      xl: 1900,\n      xxl: 1900\n    }\n  },\n  userConfig: {\n    type: undefined,\n    age: undefined,\n    gender: undefined\n  },\n  conflictManagementConfig: {\n    'blocking.ad.unit.name': [{\n      onsize: '1280x200,970x250,3x3',\n      avoid: 'blocked.ad.unit.name'\n    }, {\n      onsize: '1280x200,970x250,3x3',\n      avoid: 'blocked.ad.unit.name'\n    }]\n  },\n  impressionManagerConfig: {\n    'ad.unit.name': {\n      target: 'all|section|homepage',\n      frequency: '$1/$2(day|hour)',\n      exposed: 0,\n      expires: new Date().getTime()\n    }\n  },\n  googleGlobalSettings: {\n    enableSingleRequest: true,\n    enableAsyncRendering: true,\n    refreshIntervalTime: 1000,\n    breakpointType: 'type1'\n  },\n  sso: ssoKey\n\n}, dfpBaseConf);\n\n/**\n * Helper function. Adds N hours to a given date object.\n * @param {Date} date - the date to derive from\n * @param {Number} hours - the amount of hours to add, in whole numbers\n * @throws {SyntaxError} Will throw if the 'date' param is not provided\n * @throws {SyntaxError} Will throw if the 'hours' param is not provided\n * @throws {TypeError} Will throw if the 'hours' param is not a valid integer\n * @returns {Date} date - the new date, derived from adding the given hours\n */\nfunction addHours(date, hours) {\n  if (!date) {\n    throw new SyntaxError('addHours called without a required \\'date\\' parameter!');\n  }\n  if (!hours) {\n    throw new SyntaxError('addHours called without a required \\'hours\\' parameter!');\n  } else if (isNaN(parseInt(hours, 10))) {\n    throw new TypeError('addHours called with an invalid integer \\'hours\\' parameter!');\n  }\n  var result = new Date(date);\n  result.setHours(result.getHours() + parseInt(hours, 10));\n  return result;\n}\n\n/**\n * Helper function. Adds N days to a given date object.\n * @param {Date} date - the date to derive from\n * @param {Integer} days - the amount of days to add\n * @throws {SyntaxError} Will throw if the 'date' param is not provided\n * @throws {SyntaxError} Will throw if the 'days' param is not provided\n * @throws {TypeError} Will throw if the 'hours' param is not a valid integer\n * @returns {Date} date - the new date, derived from adding the given days\n */\nfunction addDays(date, days) {\n  if (!date) {\n    throw new SyntaxError('addDays called without a required \\'date\\' parameter!');\n  }\n  if (!days) {\n    throw new SyntaxError('addDays called without a required \\'days\\' parameter!');\n  } else if (isNaN(parseInt(days, 10))) {\n    throw new TypeError('addDays called with an invalid integer \\'days\\' parameter!');\n  }\n  var result = new Date(date);\n  result.setDate(result.getDate() + parseInt(days, 10));\n  return result;\n}\n\nvar breakpoints = dfpConfig.breakpointsConfig.breakpoints;\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @param { function } func - the function to run\n * @param { number } wait - the timeout period to avoid running the function\n * @param { boolean } immediate - leading edge modifier\n * @returns {function } the debounced function\n */\nfunction debounce(func) {\n  var wait = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;\n  var immediate = arguments[2];\n\n  var timeout = void 0;\n  return function debounced() {\n    var context = this;\n    var args = arguments; // eslint-disable-line prefer-rest-params\n    var later = function later() {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\n/**\n * Returns the current breakpoint that is closest to the window's width\n * @returns {number} the break that the current width represents\n */\nfunction getBreakpoint() {\n  var breakpoint = void 0;\n  var windowWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n  switch (true) {\n    case windowWidth < breakpoints.xs:\n      breakpoint = breakpoints.xxs;break;\n    case windowWidth < breakpoints.s:\n      breakpoint = breakpoints.xs;break;\n    case windowWidth < breakpoints.m:\n      breakpoint = breakpoints.s;break;\n    case windowWidth < breakpoints.l:\n      breakpoint = breakpoints.m;break;\n    case windowWidth < breakpoints.xl:\n      breakpoint = breakpoints.l;break;\n    case windowWidth < breakpoints.xxl:\n      breakpoint = breakpoints.xl;break;\n    default:\n      breakpoint = breakpoints.xxl;\n  }\n  return breakpoint;\n}\n/**\n * Returns the current breakpoint that is closest to the window's width\n * @param {number} breakpoint - the breakpoint label enumerator that the current width represents\n * (yield with a getBreakpoint() call or passed manually )\n * @returns {string} breakpoint - the breakpoint label that the current width represents,\n * as a string\n */\nfunction getBreakpointName(breakpoint) {\n  var resultBreakpoint = void 0;\n  var windowWidth = breakpoint || window.innerWidth;\n  switch (true) {\n    case windowWidth < breakpoints.xs:\n      resultBreakpoint = 'xxs';break;\n    case windowWidth < breakpoints.s:\n      resultBreakpoint = 'xs';break;\n    case windowWidth < breakpoints.m:\n      resultBreakpoint = 's';break;\n    case windowWidth < breakpoints.l:\n      resultBreakpoint = 'm';break;\n    case windowWidth < breakpoints.xl:\n      resultBreakpoint = 'l';break;\n    case windowWidth < breakpoints.xxl:\n      resultBreakpoint = 'xl';break;\n    default:\n      resultBreakpoint = 'xxl';\n  }\n  return resultBreakpoint;\n}\n\nvar keys = {\n  impressions: 'impressions',\n  frequency: 'frequency',\n  /**\n   * [0] - full match\n   * [1] - impression count i.e: \"1\" | \"22\"\n   * [2] - impression expiry range quantifier  i.e: \"1\" | \"22\"\n   * [3] - impression expiry range unit i.e: \"day\" | \"hour\"\n   */\n  frequencyRegex: /(\\d+)\\/(\\d+)(day|hour)/,\n  expires: 'expires',\n  exposed: 'exposed',\n  target: 'target',\n  maxImpressions: 'maxImpressions',\n  hours: 'hour',\n  days: 'day',\n  adSlotId: 'id'\n};\n\nvar ImpressionsManager = function () {\n  function ImpressionsManager(impressionManagerConfig) {\n    _classCallCheck(this, ImpressionsManager);\n\n    this.now = new Date().getTime(); // this date is used for comparisons only\n    this.config = Object.assign({}, impressionManagerConfig);\n    this.impressions = this.retrieveImpressionsData();\n    this.initImpressionMap();\n  }\n\n  _createClass(ImpressionsManager, [{\n    key: 'retrieveImpressionsData',\n    value: function retrieveImpressionsData() {\n      var _this = this;\n\n      var impressions = this.migrateImpressionsData();\n      /*\n       Merge migrated data with new data\n       console.log('Migrated: ',impressions);\n       */\n      Object.keys(impressions).map(function (key, index) {\n        impressions[key] = Object.assign({}, impressions[key], _this.config[key]);\n        return _this;\n      });\n      /*\n       console.log('Merged: ',impressions);\n       Filter out entries without frequency\n       */\n      for (var key in impressions) {\n        if ({}.hasOwnProperty.call(impressions, key)) {\n          if (!impressions[key][keys.frequency]) {\n            // console.log(`Removing ${key} - since it does not have a frequency`,impressions[key]);\n            delete impressions[key];\n          }\n        }\n      }\n      // console.log('Filtered: ',impressions);\n      return impressions;\n    }\n  }, {\n    key: 'migrateImpressionsData',\n    value: function migrateImpressionsData() {\n      var _this2 = this;\n\n      var impressions = void 0;\n      var impressionsData = void 0;\n      try {\n        impressionsData = window.localStorage.getItem(keys.impressions);\n      } catch (err) {\n        // In case of thrown 'SecurityError' or 'QuotaExceededError', the variable should be undefined\n        impressionsData = undefined;\n      }\n      try {\n        impressions = JSON.parse(impressionsData);\n      } catch (err) {\n        // Here is where old impression data is converted to new format\n        impressions = {};\n        var oldImpressionsArray = impressionsData.split(';').filter(function (e) {\n          return e;\n        });\n\n        oldImpressionsArray.forEach(function (impression) {\n          try {\n            var adUnitImpression = impression.split(' = ');\n            var name = adUnitImpression[0];\n            var data = adUnitImpression[1];\n            var tmp = name.split('.');\n            var target = tmp.pop();\n            if (target && target === 'hp') {\n              target = 'homepage';\n            }\n            var slotId = tmp.join('.');\n            var id = slotId + '_' + target;\n            var exposed = parseInt(data.split('/')[0], 10) || 0;\n            var expires = parseInt(data.split('/')[1], 10) || _this2.now;\n            impressions[id] = {};\n            impressions[id][keys.adSlotId] = slotId;\n            impressions[id][keys.target] = target;\n            impressions[id][keys.exposed] = exposed;\n            impressions[id][keys.expires] = expires;\n          } catch (err1) {\n            // console.log(`Failed converting impression: ${impression}`, err1);\n          }\n        });\n      }\n      return impressions || {};\n    }\n\n    /**\n     * Define the debounced version of the local storage save\n     */\n\n  }, {\n    key: 'saveImpressionsToLocalStorage',\n    value: function saveImpressionsToLocalStorage() {\n      if (this.debouncedSave && typeof this.debouncedSave === 'function') {\n        this.debouncedSave();\n      } else {\n        this.debouncedSave = debounce(this.saveImpressionsToLocalStorageImpl, 250, false);\n        this.debouncedSave();\n      }\n    }\n\n    /**\n     * Implementation of saving the impression map to localstorage\n     */\n\n  }, {\n    key: 'saveImpressionsToLocalStorageImpl',\n    value: function saveImpressionsToLocalStorageImpl() {\n      try {\n        localStorage.setItem(keys.impressions, JSON.stringify(this.impressions));\n      } catch (err) {\n        /* In case of thrown 'SecurityError' or 'QuotaExceededError',\n         the operation should not break*/\n        console.error('localStorage isn\\'t available:', err); // eslint-disable-line no-console\n      }\n    }\n\n    /**\n     * Initializes the impression map based on the retrieved impressions and the global\n     * configuration.\n     */\n\n  }, {\n    key: 'initImpressionMap',\n    value: function initImpressionMap() {\n      var _this3 = this;\n\n      Object.keys(this.config).map(function (key, index) {\n        var adSlotId = key;\n        var slot = _this3.impressions[adSlotId];\n        var shouldUpdateExpiryDate = false;\n        // Case I: Existing slot (update)\n        if (slot) {\n          // Case I.I Existing slot, frequency has changed\n          if (_this3.config[adSlotId][keys.frequency] !== slot[keys.frequency]) {\n            // Updating the frequency will trigger a new expiry date\n            shouldUpdateExpiryDate = true;\n            _this3.impressions[adSlotId][keys.frequency] = _this3.config[adSlotId][keys.frequency];\n          } // Case I.II Existing slot, old expiry date\n          else if (_this3.now > slot[keys.expires]) {\n              // Old value that should trigger a new expiry date\n              shouldUpdateExpiryDate = true;\n            }\n        } // Case II: Non-existing slot (create new slot)\n        else {\n            _this3.initSlotFromConfig(adSlotId);\n          } // Finally, updates the expiry date (cases I.I and I.II)\n        if (shouldUpdateExpiryDate) {\n          _this3.updateExpiryDate(adSlotId);\n        }\n        return _this3;\n      });\n    }\n\n    /**\n     * Updates the expiry date of a slotName based on the configured slot frequency\n     * @param {String} slotName - the slotName to update.\n     */\n\n  }, {\n    key: 'updateExpiryDate',\n    value: function updateExpiryDate(slotName) {\n      var now = new Date();\n      if (!(this.impressions[slotName] && this.impressions[slotName][keys.frequency])) {\n        throw new Error('Unable to update expiry date for slot: ' + slotName + '\\n      - this.impressions[slotName]:', this.impressions[slotName]);\n      }\n      var frequencyMap = this.impressions[slotName][keys.frequency].match(keys.frequencyRegex);\n      now.setMilliseconds(0);\n      now.setSeconds(0);\n      now.setMinutes(0);\n      if (frequencyMap.indexOf(keys.days) > -1) {\n        now.setHours(0);\n      }\n      this.impressions[slotName][keys.expires] = (frequencyMap.indexOf(keys.days) > -1 ? addDays(now, frequencyMap[2]) : addHours(now, frequencyMap[2])).getTime();\n\n      // Set max impressions:\n      this.impressions[slotName][keys.maxImpressions] = parseInt(frequencyMap[1], 10);\n      // Reset exposed\n      this.impressions[slotName][keys.exposed] = 0;\n    }\n\n    /**\n     * Initializes a non-existing slot from the passed global configuration for the slot\n     * @param {String} slotName - the name of the slot to create\n     */\n\n  }, {\n    key: 'initSlotFromConfig',\n    value: function initSlotFromConfig(slotName) {\n      var slot = this.impressions[slotName] || {};\n      slot[keys.frequency] = this.config[slotName][keys.frequency];\n      slot[keys.target] = this.config[slotName][keys.target];\n      slot[keys.exposed] = 0;\n      this.impressions[slotName] = slot;\n      this.updateExpiryDate(slotName);\n    }\n\n    /**\n     * Registers an impression for a given adSlot.\n     * @param {String} adSlotId - the adSlot id to register an impression for\n     * @returns {boolean} returns true iff the impression has been registered\n     */\n\n  }, {\n    key: 'registerImpression',\n    value: function registerImpression(adSlotId) {\n      if (adSlotId) {\n        var slot = this.impressions[adSlotId];\n        if (slot) {\n          var exposed = slot[keys.exposed];\n          if (isNaN(parseInt(exposed, 10)) === false) {\n            this.impressions[adSlotId][keys.exposed] += 1;\n            try {\n              this.saveImpressionsToLocalStorage();\n            } catch (err) {\n              // console.log('Error saving ad impressions to localStorage!', err);\n            }\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n\n    /**\n     * Checks whether an adSlot has reached it's allocated impressions count.\n     * @param {String} adSlotId - the adSlot to check\n     * @returns {boolean} true iff there is a quota for the adSlot, and it has been reached\n     */\n\n  }, {\n    key: 'reachedQuota',\n    value: function reachedQuota(adSlotId) {\n      // An adSlotId is suffixed with _homepage | _section if it's targeting is different\n      // between the two. If there is no difference, an _all suffix can be used.\n      var slotName = this.impressions['' + adSlotId + dfpConfig.department] ? '' + adSlotId + dfpConfig.department : adSlotId + '_all';\n\n      var slot = this.impressions[slotName];\n      var atQuota = false;\n      if (slot) {\n        var now = new Date().getTime();\n        // Second element of 2/4day matches '2'\n        var expires = this.impressions[slotName][keys.expires];\n        if (expires < now) {\n          this.updateExpiryDate(slotName);\n        } else {\n          var maxImpressions = this.impressions[slotName][keys.maxImpressions];\n          // Not expired, did reach max impressions?\n          if (maxImpressions) {\n            atQuota = this.impressions[slotName][keys.exposed] >= maxImpressions;\n          }\n        }\n      }\n      return atQuota;\n    }\n\n    /**\n     * Clears the impression map from 'exposed' impressions\n     */\n\n  }, {\n    key: 'resetImpressions',\n    value: function resetImpressions() {\n      var impressions = this.impressions;\n      for (var key in impressions) {\n        if ({}.hasOwnProperty.call(impressions, key)) {\n          if (impressions[key][keys.exposed]) {\n            impressions[key][keys.exposed] = 0;\n          }\n        }\n      }\n      this.saveImpressionsToLocalStorage();\n    }\n  }]);\n\n  return ImpressionsManager;\n}();\n\nvar userTypes = {\n  payer: 'payer',\n  registered: 'registered',\n  anonymous: 'anonymous',\n  trial: 'trial'\n};\n\nvar productTypes = {\n  htz: 243,\n  tm: 273,\n  hdc: 239,\n  htz_tm: 274\n};\n\nvar User = function () {\n  function User(config) {\n    _classCallCheck(this, User);\n\n    this.config = Object.assign({}, config.userConfig);\n    var cookieMap = getCookieAsMap();\n    this.ssoKey = dfpConfig.sso;\n    if (!cookieMap[this.ssoKey]) {\n      // Flips the ssoKey, since cookieMap.ssoKey cannot be used to retrieve data\n      this.ssoKey = this.ssoKey === 'tmsso' ? 'engsso' : 'tmsso';\n    }\n    this.type = this.getUserType(cookieMap);\n    this.htz_type = this.getUserTypeByProduct(cookieMap, productTypes.htz);\n    this.tm_type = this.getUserTypeByProduct(cookieMap, productTypes.tm);\n    this.hdc_type = this.getUserTypeByProduct(cookieMap, productTypes.hdc);\n    this.impressionManager = new ImpressionsManager(config.impressionManagerConfig);\n    this.age = this.getUserAge(cookieMap);\n    this.gender = this.getUserGender(cookieMap);\n    this.sso = this.getUserSSO(cookieMap, this.ssoKey);\n  }\n\n  _createClass(User, [{\n    key: 'getUserType',\n    value: function getUserType(cookieMap) {\n      var userType = void 0;\n      if (cookieMap && cookieMap[this.ssoKey]) {\n        var payerProp = window.location.hostname.indexOf('haaretz.com') > -1 ? 'HdcPusr' : 'HtzPusr';\n        userType = cookieMap[payerProp] ? userTypes.payer : userTypes.registered;\n      } else {\n        userType = userTypes.anonymous;\n      }\n      return userType;\n    }\n  }, {\n    key: 'getUserTypeByProduct',\n    value: function getUserTypeByProduct(cookieMap, productType) {\n      var userType = userTypes.anonymous;\n      if (cookieMap && cookieMap[this.ssoKey]) {\n        if (cookieMap.userProducts) {\n          var userProducts = decodeURIComponent(cookieMap.userProducts);\n          userProducts = JSON.parse(userProducts);\n          if (productType === productTypes.hdc) {\n            userType = this.getHdcUserType(userProducts);\n          } else {\n            userType = this.getHtzTmUserType(userProducts, productType);\n          }\n        }\n      }\n      return userType;\n    }\n  }, {\n    key: 'getHdcUserType',\n    value: function getHdcUserType(userProducts) {\n      // user has hdc paying product\n      if (this.userHasProduct(userProducts, productTypes.hdc, false)) {\n        return userTypes.payer;\n      }\n      // user has hdc trial product\n      else if (this.userHasProduct(userProducts, productTypes.hdc, true)) {\n          return userTypes.trial;\n        }\n      return userTypes.registered;\n    }\n  }, {\n    key: 'getHtzTmUserType',\n    value: function getHtzTmUserType(userProducts, productType) {\n      // user has htz/tm paying product\n      if (this.userHasProduct(userProducts, productType, false) || this.userHasProduct(userProducts, productTypes.htz_tm, false)) {\n        return userTypes.payer;\n      }\n      // user has htz/tm trial product\n      else if (this.userHasProduct(userProducts, productType, true) || this.userHasProduct(userProducts, productTypes.htz_tm, true)) {\n          return userTypes.trial;\n        }\n      return userTypes.registered;\n    }\n  }, {\n    key: 'userHasProduct',\n    value: function userHasProduct(userProducts, productType, trial) {\n      return userProducts.products.filter(function (product) {\n        return product.prodNum === productType && product.trial === trial;\n      }).length > 0;\n    }\n  }, {\n    key: 'getUserAge',\n    value: function getUserAge(cookieMap) {\n      var age = void 0;\n      var usrae = cookieMap[this.ssoKey] && cookieMap[this.ssoKey].usrae;\n      if (usrae) {\n        age = parseInt(cookieMap[this.ssoKey].usrae, 10);\n        age = age > 0 ? age : undefined;\n      }\n      return age;\n    }\n  }, {\n    key: 'getUserGender',\n    value: function getUserGender(cookieMap) {\n      var gender = void 0;\n      var urgdr = cookieMap[this.ssoKey] && cookieMap[this.ssoKey].urgdr;\n      if (urgdr) {\n        gender = parseInt(cookieMap[this.ssoKey].urgdr, 10);\n        gender = gender === 2 || gender === 1 ? gender : undefined;\n      }\n      return gender;\n    }\n  }, {\n    key: 'getUserSSO',\n    value: function getUserSSO(cookieMap, ssoKey$$1) {\n      return cookieMap[ssoKey$$1];\n    }\n  }]);\n\n  return User;\n}();\n\nvar ConflictResolver = function () {\n  function ConflictResolver(conflictManagementConfig) {\n    _classCallCheck(this, ConflictResolver);\n\n    this.dependencyMap = this.initializeDependencyMap(conflictManagementConfig);\n    this.deferredSlots = new Set();\n  }\n\n  _createClass(ConflictResolver, [{\n    key: 'initializeDependencyMap',\n    value: function initializeDependencyMap(conflictManagementJson) {\n      var _this = this;\n\n      var queue = new Map();\n      Object.keys(conflictManagementJson).map(function (key, value) {\n        var rules = conflictManagementJson[key];\n        if (rules) {\n          rules = rules.filter(function (item) {\n            return item.onsize && item.avoid;\n          });\n        }\n        queue.set(key, {\n          id: key,\n          rules: rules,\n          resolvedWith: null\n        });\n        return _this;\n      });\n      return queue;\n    }\n  }, {\n    key: 'updateResolvedSlot',\n    value: function updateResolvedSlot(adSlotId, resolvedSize) {\n      if (!adSlotId) {\n        throw new Error('updateResolvedSlot must be called with an adSlotId!');\n      }\n      if (!resolvedSize) {\n        throw new Error('updateResolvedSlot must be called with a resolved size!');\n      }\n      if (this.dependencyMap.has(adSlotId)) {\n        this.dependencyMap.get(adSlotId).resolvedWith = resolvedSize;\n      }\n    }\n  }, {\n    key: 'isBlocked',\n    value: function isBlocked(adSlotId) {\n      var _this2 = this;\n\n      if (!adSlotId) {\n        throw new Error('isBlocked must be called with an adSlotId!');\n      }\n      var isBlocked = false;\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this.dependencyMap.keys()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var adSlotKey = _step.value;\n\n          var adSlot = this.dependencyMap.get(adSlotKey);\n          var _iteratorNormalCompletion2 = true;\n          var _didIteratorError2 = false;\n          var _iteratorError2 = undefined;\n\n          try {\n            for (var _iterator2 = adSlot.rules[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n              var adSlotRule = _step2.value;\n\n              // Found rule specific to our target\n              if (adSlotRule.avoid === adSlotId) {\n                (function () {\n                  var parentResolvedWith = adSlot.resolvedWith;\n                  // Fail fast: parent is not resolved yet - unknown returned size.\n                  if (!parentResolvedWith) {\n                    isBlocked = true;\n                    _this2.deferredSlots.add(adSlotId);\n                  }\n                  if (adSlotRule.onsize.split(',').find(function (sizeString) {\n                    // eslint-disable-line\n                    var size = sizeString.split('x').map(function (numberStr) {\n                      return parseInt(numberStr, 10);\n                    });\n                    return _this2.arraysEqual(size, parentResolvedWith);\n                  })) {\n                    // Block found\n                    _this2.deferredSlots.add(adSlotId);\n                    isBlocked = true;\n                  }\n                })();\n              }\n            }\n          } catch (err) {\n            _didIteratorError2 = true;\n            _iteratorError2 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                _iterator2.return();\n              }\n            } finally {\n              if (_didIteratorError2) {\n                throw _iteratorError2;\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return isBlocked;\n    }\n  }, {\n    key: 'isBlocking',\n    value: function isBlocking(adSlotId) {\n      if (!adSlotId) {\n        throw new Error('isBlocking must be called with an adSlotId!');\n      }\n      var isBlocking = false;\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = this.dependencyMap.keys()[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var adSlotKey = _step3.value;\n\n          if (adSlotKey === adSlotId) {\n            isBlocking = true;\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      return isBlocking;\n    }\n\n    /**\n     * Gets an array of adSlot Ids for a given adSlotId, that are dependent on (blocked by)\n     * @param {String} adSlotId - the blocking slot id\n     * @return {Array} an array of blocked slot, that has a dependency on the given slot\n     */\n\n  }, {\n    key: 'getBlockedSlotsIds',\n    value: function getBlockedSlotsIds(adSlotId) {\n      var result = void 0;\n      if (this.dependencyMap.has(adSlotId)) {\n        result = Array.from(this.dependencyMap.get(adSlotId).rules.map(function (adSlot) {\n          return adSlot.avoid;\n        }));\n      }\n      return result || [];\n    }\n  }, {\n    key: 'arraysEqual',\n    value: function arraysEqual(a, b) {\n      if (a === b) return true;\n      if (a === null || b === null) return false;\n      if (a.length !== b.length) return false;\n      for (var i = 0; i < a.length; ++i) {\n        if (a[i] !== b[i]) return false;\n      }\n      return true;\n    }\n  }]);\n\n  return ConflictResolver;\n}();\n\nConflictResolver.EMPTY_SIZE = [];\n\n/**\n * Checks whether two arrays are equal\n * @param {Array} a - the first array to check\n * @param {Array} b - the second array to check\n * @returns {Boolean} true iff both a and b are arrays, with equal values\n */\nfunction arraysEqual(a, b) {\n  if (!a || !b) return false;\n  if (!Array.isArray(a) || !Array.isArray(b)) return false;\n  if (a === b) return true;\n  if (a.length !== b.length) return false;\n  for (var i = 0; i < a.length; ++i) {\n    if (Array.isArray(a[i]) && Array.isArray(b[i])) {\n      if (!arraysEqual(a[i], b[i])) return false;\n    } else if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nvar hiddenClass = dfpConfig.site.indexOf('mouse') > -1 ? 'u-is-hidden' : 'h-hidden';\n\nvar adSlot = function () {\n  function adSlot(adSlotConfig) {\n    _classCallCheck(this, adSlot);\n\n    this.config = Object.assign({}, adSlotConfig);\n\n    // Part I : Markup configuration - passed from AdManager\n    this.id = this.config.id;\n    if (!this.config.id) {\n      throw new Error('an adSlot requires an id!');\n    }\n    this.target = this.config.target;\n    this.type = this.config.type;\n    this.responsive = this.config.responsive;\n    this.fluid = this.config.fluid;\n    this.user = this.config.user;\n    this.adManager = this.config.adManager;\n    this.htmlElement = this.config.htmlElement;\n    this.priority = this.config.priority;\n    this.deferredSlot = this.config.deferredSlot;\n\n    // Part II : Global, general ad configuration - passed from AdManager\n    this.department = this.config.department;\n    this.network = this.config.network;\n    this.adUnitBase = this.config.adUnitBase;\n\n    // Part III : ad specific configuration - passed from globalConfig.adSlotConfig\n    this.adSizeMapping = this.config.adSizeMapping;\n    this.responsiveAdSizeMapping = this.config.responsiveAdSizeMapping;\n    this.blacklistReferrers = this.config.blacklistReferrers ? this.config.blacklistReferrers.split(',') : [];\n    this.whitelistReferrers = this.config.whitelistReferrers ? this.config.whitelistReferrers.split(',') : [];\n\n    // Part IV : Runtime configuration - calculated data - only present in runtime\n    this.lastResolvedSize = undefined; // Initialized in 'slotRenderEnded' callback\n    this.lastResolvedWithBreakpoint = undefined; // Initialized in 'slotRenderEnded' callback\n    this.slot = undefined; // Holds a googletag.Slot object\n    // [https://developers.google.com/doubleclick-gpt/reference#googletag.Slot]\n    try {\n      if (!this.deferredSlot) {\n        this.slot = this.defineSlot();\n      }\n    } catch (err) {\n      console.error(err); // eslint-disable-line no-console\n    }\n  }\n\n  /**\n   * Checks whether this adSlot is an 'Out-of-page' slot or not.\n   * An Out-of-page slot is a slot that is not embedded in the page 'normally'.\n   * @returns {boolean} true iff this adSlot is one of the predefined 'out-of-page' slots.\n   */\n\n  _createClass(adSlot, [{\n    key: 'isOutOfPage',\n    value: function isOutOfPage() {\n      if (typeof this.type !== 'string') {\n        throw new Error('An adSlot cannot by typeless!', this);\n      }\n      if (this.isMobile() === true) {\n        return false;\n      }\n      switch (this.type) {\n        case adTypes.maavaron:\n          return false;\n        case adTypes.popunder:\n          return true;\n        case adTypes.talkback:\n          return false;\n        case adTypes.regular:\n          return false;\n        default:\n          return false;\n      }\n    }\n\n    /**\n     * Checks whether this adSlot is a 'maavaron' slot or not.\n     * An Out-of-page slot is a slot that is not embedded in the page 'normally'.\n     * @returns {boolean} true iff this adSlot is one of the predefined 'out-of-page' slots.\n     */\n\n  }, {\n    key: 'isMaavaron',\n    value: function isMaavaron() {\n      if (typeof this.type !== 'string') {\n        throw new Error('An adSlot cannot by typeless!', this);\n      }\n      if (this.isMobile() === true) {\n        return false;\n      }\n      switch (this.type) {\n        case adTypes.maavaron:\n          return false;\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: 'isMobile',\n    value: function isMobile() {\n      return (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent || '')\n      );\n    }\n    /**\n     * Checks whether or not this adSlot has a non-empty whitelist, and if so, that the current\n     * referrer appears in the whitelist.\n     * Should return false iff there is a whitelist for the current adSlot, but the referrer is not\n     * mentioned in the whitelist.\n     * @returns {boolean} true iff the ad can be displayed.\n     */\n\n  }, {\n    key: 'isWhitelisted',\n    value: function isWhitelisted() {\n      var whitelisted = false;\n      if (this.whitelistReferrers.length !== 0) {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = this.whitelistReferrers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var referrer = _step.value;\n\n            if (dfpConfig.referrer.indexOf(referrer) > -1) {\n              whitelisted = true;\n              break;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n      } else {\n        whitelisted = true;\n      }\n      return whitelisted;\n    }\n\n    /**\n     * Checks whether or not this adSlot has a non-empty blacklist, and if so, that the current\n     * referrer does not appear in the blacklist.\n     * Should return true iff there is a blacklist for the current adSlot, and the referrer is\n     * mentioned in the blacklist - to indicate that the adSlot is 'blocked'.\n     * @returns {boolean} true iff the ad cannot be displayed.\n     */\n\n  }, {\n    key: 'isBlacklisted',\n    value: function isBlacklisted() {\n      var blacklisted = false;\n      if (this.blacklistReferrers.length !== 0) {\n        var _iteratorNormalCompletion2 = true;\n        var _didIteratorError2 = false;\n        var _iteratorError2 = undefined;\n\n        try {\n          for (var _iterator2 = this.blacklistReferrers[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n            var referrer = _step2.value;\n\n            if (dfpConfig.referrer.indexOf(referrer) > -1) {\n              blacklisted = true;\n              break;\n            }\n          }\n        } catch (err) {\n          _didIteratorError2 = true;\n          _iteratorError2 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n              _iterator2.return();\n            }\n          } finally {\n            if (_didIteratorError2) {\n              throw _iteratorError2;\n            }\n          }\n        }\n      }\n      return blacklisted;\n    }\n\n    /**\n     * Shows the current adSlot.\n     * It assumes a markup is available for this slot (any tag with an id attribute = this.id)\n     */\n\n  }, {\n    key: 'show',\n    value: function show() {\n      var _this = this;\n\n      if (!this.shown === true) {\n        this.shown = true; // Ensure show will be called once per adSlot\n        googletag.cmd.push(function () {\n          if (_this.deferredSlot) {\n            _this.slot = _this.defineSlot();\n          }\n          // console.log('calling show for slot',this.id,' called @',window.performance.now());\n          document.getElementById(_this.id).classList.remove(hiddenClass);\n          googletag.display(_this.id);\n        });\n      }\n    }\n\n    /**\n     * Shows the current adSlot.\n     * It assumes a markup is available for this slot (any tag with an id attribute = this.id)\n     */\n\n  }, {\n    key: 'hide',\n    value: function hide() {\n      var _this2 = this;\n\n      googletag.cmd.push(function () {\n        document.getElementById(_this2.id).classList.add(hiddenClass);\n      });\n    }\n\n    /**\n     * Initializes page-level slot definition for the current slot\n     * @return {Slot} slot - the Google Slot that was defined from this AdSlot configuration\n     */\n\n  }, {\n    key: 'defineSlot',\n    value: function defineSlot() {\n      if (this.isMaavaron()) {\n        var maavaronSlot = this.defineMaavaron();\n        if (this.adManager.shouldSendRequestToDfp(this)) {\n          if (!this.shown) {\n            this.shown = true; // Ensure show will be called once\n            maavaronSlot.display();\n          }\n        }\n        return maavaronSlot;\n      }\n      var googletag = window.googletag;\n      var pubads = googletag.pubads();\n      var args = [];\n      var defineFn = this.isOutOfPage() ? googletag.defineOutOfPageSlot : googletag.defineSlot;\n      // 3 or 2 params according to the function that we want to activate.\n      args.push(this.getPath());\n      if (this.isOutOfPage() === false) {\n        if (this.fluid) {\n          args.push('fluid');\n        } else {\n          args.push(this.adSizeMapping);\n        }\n      }\n      args.push(this.id);\n      var slot = defineFn.apply(defineFn, args);\n      if (slot) {\n        // Responsive size Mapping\n        if (this.responsive) {\n          var responsiveSlotSizeMapping = googletag.sizeMapping();\n          var breakpoints = dfpConfig.breakpointsConfig.breakpoints;\n          var keys = Object.keys(this.responsiveAdSizeMapping);\n          var _iteratorNormalCompletion3 = true;\n          var _didIteratorError3 = false;\n          var _iteratorError3 = undefined;\n\n          try {\n            for (var _iterator3 = keys[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n              var key = _step3.value;\n              // ['xxs','xs',...]\n              responsiveSlotSizeMapping.addSize([breakpoints[key], 100], // 100 is a default height, since it is height agnostic\n              !arraysEqual(this.responsiveAdSizeMapping[key], [[0, 0]]) ? this.responsiveAdSizeMapping[key] : []);\n            }\n          } catch (err) {\n            _didIteratorError3 = true;\n            _iteratorError3 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                _iterator3.return();\n              }\n            } finally {\n              if (_didIteratorError3) {\n                throw _iteratorError3;\n              }\n            }\n          }\n\n          responsiveSlotSizeMapping = responsiveSlotSizeMapping.build();\n          slot = slot.defineSizeMapping(responsiveSlotSizeMapping);\n        }\n        slot = slot.addService(pubads);\n        if (this.isOutOfPage() === false) {\n          slot.setCollapseEmptyDiv(true);\n        }\n      }\n      return slot;\n    }\n\n    /**\n     * Returns the current path calculated for the adSlot\n     * @returns {String} a formatted string that represent the path for the slot definition\n     */\n\n  }, {\n    key: 'getPath',\n    value: function getPath() {\n      var _this3 = this;\n\n      /* eslint-disable no-shadow */\n      var path = dfpConfig.path || [];\n      path = path.filter(function (path) {\n        return path !== '.';\n      });\n      path = path.map(function (section) {\n        return '' + _this3.id + _this3.department + section;\n      }).join('/');\n      // If a path exist, it will be preceded with a forward slash\n      path = path && this.config.department !== '_homepage' ? '/' + path : '';\n      /* eslint-enable no-shadow */\n      var calculatedPath = '/' + this.config.network + '/' + this.config.adUnitBase + '/' + this.id + '/' + this.id + this.department + path; // eslint-disable-line max-len\n      return calculatedPath.toLowerCase();\n    }\n\n    /* eslint-disable */\n\n  }, {\n    key: 'slotRendered',\n    value: function slotRendered(event) {\n      var id = event.slot.getAdUnitPath().split('/')[3]; // Convention: [0]/[1]network/[2]base/[3]id\n      var isEmpty = event.isEmpty; // Did the ad return as empty?\n      var resolvedSize = event.size; // What 'creative' size did the ad return with?\n      // Empty or onload callback should be called next?\n    }\n    /* eslint-enable */\n\n    /**\n     * Refresh this adSlot\n     */\n\n  }, {\n    key: 'refresh',\n    value: function refresh() {\n      var _this4 = this;\n\n      googletag.cmd.push(function () {\n        googletag.pubads().refresh([_this4.slot]);\n      });\n    }\n\n    /**\n     * Shows 'Maavaron' type adSlot using Passback definition\n     * @return {Slot} slot - the Google Slot that was defined for Maavaron\n     */\n\n  }, {\n    key: 'defineMaavaron',\n    value: function defineMaavaron() {\n      if (!document.referrer.match('loc.haaretz')) {\n        var adUnitMaavaronPath = this.getPath();\n        var adUnitMaavaronSize = [[2, 1]];\n        var slot = googletag.pubads().definePassback(adUnitMaavaronPath, adUnitMaavaronSize).setTargeting('UserType', [this.user.type]).setTargeting('age', [this.user.age]).setTargeting('urgdr', [this.user.gender]).setTargeting('articleId', [dfpConfig.articleId]).setTargeting('stg', [dfpConfig.environment]);\n        return slot;\n      }\n      return null;\n    }\n  }]);\n\n  return adSlot;\n}();\n\n// There are a total of 7 adTargets:\n// \"all\",\"nonPaying\",\"anonymous\",\"registered\",\"paying\",\"digitalOnly\" and \"digitalAndPrint\"\nvar adPriorities = {\n  high: 'high',\n  normal: 'normal',\n  low: 'low'\n};\n\nvar adTargets = {\n  all: 'all',\n  nonPaying: 'nonPaying',\n  anonymous: 'anonymous',\n  registered: 'registered',\n  paying: 'paying',\n  digitalOnly: 'digitalOnly',\n  digitalAndPrint: 'digitalAndPrint'\n};\n\n// There are a total of 3 userTypes: \"anonymous\", \"registered\" and \"payer\"\nvar userTypes$1 = {\n  anonymous: 'anonymous',\n  registered: 'registered',\n  payer: 'payer'\n};\n\nvar adTypes = {\n  maavaron: '.maavaron',\n  popunder: '.popunder',\n  talkback: '.talkback',\n  regular: ''\n};\n\nvar AdManager = function () {\n  function AdManager(config) {\n    var _this = this;\n\n    _classCallCheck(this, AdManager);\n\n    this.config = Object.assign({}, config);\n    this.user = new User(config);\n    this.conflictResolver = new ConflictResolver(config.conflictManagementConfig);\n    /**\n     * Avoid race conditions by making sure to respect the usual timing of GPT.\n     * This DFP implementation uses Enable-Define-Display:\n     * Define page-level settings\n     * enableServices()\n     * Define slots\n     * Display slots\n     */\n    try {\n      googletag.cmd.push(function () {\n        _this.initGoogleTargetingParams(); //  Define page-level settings\n        _this.initGoogleGlobalSettings(); //  enableServices()\n        _this.initSlotRenderedCallback(); //  Define callbacks\n      });\n      // Mouse special treatment to base path on mobile breakpoints\n      var currentBreakpointName = getBreakpointName(getBreakpoint());\n      if (this.config.adManagerConfig.adUnitBase.indexOf('mouse.co.il') > -1 && currentBreakpointName.indexOf('xs') > -1) {\n        this.config.adManagerConfig.adUnitBase = 'mouse.co.il.mobile_web';\n      }\n      // Holds adSlot objects as soon as possible.\n      googletag.cmd.push(function () {\n        _this.adSlots = _this.initAdSlots(config.adSlotConfig, adPriorities.high);\n      });\n      // Once DOM ready, add more adSlots.\n      var onDomLoaded = function onDomLoaded() {\n        // eslint-disable-line no-inner-declarations\n        try {\n          googletag.cmd.push(function () {\n            _this.adSlots = _this.initAdSlots(config.adSlotConfig, adPriorities.high);\n            googletag.cmd.push(function () {\n              _this.adSlots = _this.initAdSlots(config.adSlotConfig, adPriorities.normal);\n            });\n          });\n        } catch (err) {\n          console.log(err); // eslint-disable-line no-console\n        }\n      };\n      // Once window was loaded, add the rest of the adSlots.\n      var onWindowLoaded = function onWindowLoaded() {\n        // eslint-disable-line no-inner-declarations\n        googletag.cmd.push(function () {\n          _this.adSlots = _this.initAdSlots(config.adSlotConfig, adPriorities.low);\n          // Clean blocking adSlots that are not defined on this page\n          var _iteratorNormalCompletion = true;\n          var _didIteratorError = false;\n          var _iteratorError = undefined;\n\n          try {\n            for (var _iterator = _this.conflictResolver.dependencyMap.keys()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n              var blockingAdSlotKey = _step.value;\n\n              if (!_this.adSlots.has(blockingAdSlotKey)) {\n                _this.conflictResolver.dependencyMap.delete(blockingAdSlotKey);\n              }\n            }\n          } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion && _iterator.return) {\n                _iterator.return();\n              }\n            } finally {\n              if (_didIteratorError) {\n                throw _iteratorError;\n              }\n            }\n          }\n\n          _this.showAllDeferredSlots();\n        });\n      };\n      switch (document.readyState) {\n        case 'loading':\n          document.addEventListener('DOMContentLoaded', onDomLoaded);\n          window.addEventListener('load', onWindowLoaded);\n          break;\n        case 'interactive':\n          onDomLoaded();\n          window.addEventListener('load', onWindowLoaded);\n          break;\n        default:\n          // 'complete' - no need for event listeners.\n          onDomLoaded();\n          onWindowLoaded();\n      }\n    } catch (err) {\n      console.error(err); // eslint-disable-line no-console\n    }\n  }\n\n  /**\n   * Shows all of the adSlots that can be displayed.\n   */\n\n  _createClass(AdManager, [{\n    key: 'showAllSlots',\n    value: function showAllSlots() {\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = this.adSlots.keys()[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var adSlotKey = _step2.value;\n\n          var adSlot$$1 = this.adSlots.get(adSlotKey);\n          if (adSlot$$1.type !== adTypes.talkback && this.shouldSendRequestToDfp(adSlot$$1)) {\n            adSlot$$1.show();\n          }\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n    }\n\n    /**\n     * Gets all adSlots that has a certain priority\n     * @param {adPriority} priority - the priority of the ad {high, normal, low}\n     * @return {Array<AdSlot>} adSlots - all of the defined adSlots that matches\n     * the given priority\n     */\n\n  }, {\n    key: 'getAdSlotsByPriority',\n    value: function getAdSlotsByPriority(priority) {\n      function priorityFilter(adSlot$$1) {\n        return adSlot$$1.priority === priority;\n      }\n      return Array.from(this.adSlots.values()).filter(priorityFilter);\n    }\n  }, {\n    key: 'showAllDeferredSlots',\n    value: function showAllDeferredSlots() {\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = this.conflictResolver.deferredSlots[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var deferredSlotId = _step3.value;\n\n          if (this.adSlots.has(deferredSlotId)) {\n            if (!this.conflictResolver.isBlocked(deferredSlotId)) {\n              var deferredAdSlot = this.adSlots.get(deferredSlotId);\n              if (this.shouldSendRequestToDfp(deferredAdSlot)) {\n                deferredAdSlot.show();\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n    }\n\n    /**\n     * Refreshes all responsive adSlots\n     */\n\n  }, {\n    key: 'refreshAllSlots',\n    value: function refreshAllSlots() {\n      var currentBreakpoint = getBreakpoint();\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = this.adSlots.keys()[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var adSlotKey = _step4.value;\n\n          var adSlot$$1 = this.adSlots.get(adSlotKey);\n          if (adSlot$$1.responsive && adSlot$$1.type !== adTypes.maavaron) {\n            if (adSlot$$1.lastResolvedWithBreakpoint !== currentBreakpoint && this.shouldSendRequestToDfp(adSlot$$1)) {\n              // console.log(`calling refresh for adSlot: ${adSlot.id}`);\n              adSlot$$1.refresh();\n            } else {\n              adSlot$$1.hide();\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n    }\n\n    /**\n     * Refreshes all adSlots\n     */\n\n  }, {\n    key: 'refreshAllSlotsInPage',\n    value: function refreshAllSlotsInPage() {\n      var _iteratorNormalCompletion5 = true;\n      var _didIteratorError5 = false;\n      var _iteratorError5 = undefined;\n\n      try {\n        for (var _iterator5 = this.adSlots.keys()[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n          var adSlotKey = _step5.value;\n\n          var adSlot$$1 = this.adSlots.get(adSlotKey);\n          if (this.shouldSendRequestToDfp(adSlot$$1)) {\n            // console.log(`calling refresh for adSlot: ${adSlot.id}`);\n            adSlot$$1.refresh();\n          } else {\n            adSlot$$1.hide();\n          }\n        }\n      } catch (err) {\n        _didIteratorError5 = true;\n        _iteratorError5 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion5 && _iterator5.return) {\n            _iterator5.return();\n          }\n        } finally {\n          if (_didIteratorError5) {\n            throw _iteratorError5;\n          }\n        }\n      }\n    }\n\n    /**\n     * Refreshes adSlot\n     */\n\n  }, {\n    key: 'refreshSlot',\n    value: function refreshSlot(adUnitName) {\n      var adSlot$$1 = this.adSlots.get(adUnitName);\n      if (this.shouldSendRequestToDfp(adSlot$$1)) {\n        // console.log(`calling refresh for adSlot: ${adSlot.id}`);\n        adSlot$$1.refresh();\n      } else {\n        adSlot$$1.hide();\n      }\n    }\n\n    /**\n    * Initializes adSlots based on the currently found slot markup (HTML page specific),\n    * and the predefined configuration for the slots.\n    * @param {Object} adSlotConfig - the AdSlots configuration object (see: globalConfig)\n    * @param {String} filteredPriority - filters out all adSlots that does not match\n    * a given adPriority. This is used to cherry pick the init process of ads.\n    * @returns {Map}\n    */\n\n  }, {\n    key: 'initAdSlots',\n    value: function initAdSlots(adSlotConfig, filteredPriority) {\n      var _this2 = this;\n\n      var adSlots = new Map(this.adSlots);\n      var adSlotPlaceholders = Array.from(document.getElementsByClassName('js-dfp-ad'));\n      adSlotPlaceholders = adSlotPlaceholders.filter(function (node) {\n        return node.id;\n      }); // only nodes with an id\n      var adSlotNodeSet = new Set();\n      adSlotPlaceholders = Array.prototype.filter.call(adSlotPlaceholders, function (node) {\n        if (adSlotNodeSet.has(node.id) === false) {\n          // first occurrence of Node\n          adSlotNodeSet.add(node.id);\n          return true;\n        }\n        return false;\n      });\n      // adSlotPlaceholders = adSlotPlaceholders.sort((a, b) => a.offsetTop - b.offsetTop);\n      adSlotPlaceholders.forEach(function (adSlot$$1) {\n        var adSlotPriority = adSlotConfig[adSlot$$1.id] ? adSlotConfig[adSlot$$1.id].priority || adPriorities.normal : undefined;\n        if (adSlotConfig[adSlot$$1.id] && adSlots.has(adSlot$$1.id) === false && adSlotPriority === filteredPriority) {\n          // The markup has a matching configuration from adSlotConfig AND was not already defined\n          try {\n            // adSlotConfig is built from globalConfig, but can be overridden by markup\n            var computedAdSlotConfig = Object.assign({}, adSlotConfig[adSlot$$1.id], {\n              id: adSlot$$1.id,\n              target: adSlot$$1.attributes['data-audtarget'] ? adSlot$$1.attributes['data-audtarget'].value : adTargets.all,\n              type: _this2.getAdType(adSlot$$1.id),\n              responsive: adSlotConfig[adSlot$$1.id].responsive,\n              fluid: adSlotConfig[adSlot$$1.id].fluid || false,\n              user: _this2.user,\n              adManager: _this2,\n              htmlElement: adSlot$$1,\n              department: _this2.config.department,\n              network: _this2.config.adManagerConfig.network,\n              adUnitBase: _this2.config.adManagerConfig.adUnitBase,\n              deferredSlot: _this2.conflictResolver.isBlocked(adSlot$$1.id),\n              priority: adSlotPriority\n            });\n            var adSlotInstance = new adSlot(computedAdSlotConfig);\n            adSlots.set(adSlot$$1.id, adSlotInstance);\n            if (adSlotInstance.type !== adTypes.talkback && adSlotInstance.priority === adPriorities.high && _this2.shouldSendRequestToDfp(adSlotInstance)) {\n              /*\n               console.log('calling show for high priority slot', adSlotInstance.id, ' called @',\n               window.performance.now());\n               */\n              adSlotInstance.show();\n            }\n          } catch (err) {\n            console.error(err); // eslint-disable-line no-console\n          }\n        }\n      });\n      return adSlots;\n    }\n  }, {\n    key: 'isPriority',\n    value: function isPriority(adSlotId) {\n      return typeof adSlotId === 'string' && (adSlotId.indexOf('plazma') > 0 || adSlotId.indexOf('maavaron') > 0 || adSlotId.indexOf('popunder') > 0);\n    }\n\n    /**\n     * Returns the adType based on the adSlot name.\n     * @param {String} adSlotId - the adSlot's identifier.\n     * @returns {*} enumerated export 'adTypes'\n     */\n\n  }, {\n    key: 'getAdType',\n    value: function getAdType(adSlotId) {\n      if (!adSlotId) {\n        throw new Error('Missing argument: a call to getAdType must have an adSlotId');\n      }\n      if (adSlotId.indexOf(adTypes.maavaron) > -1) return adTypes.maavaron;\n      if (adSlotId.indexOf(adTypes.popunder) > -1) return adTypes.popunder;\n      if (adSlotId.indexOf(adTypes.talkback) > -1) return adTypes.talkback;\n      return adTypes.regular;\n    }\n\n    /**\n     * @param {object} adSlot the AdSlot\n     * @returns {boolean|*}\n     */\n\n  }, {\n    key: 'shouldSendRequestToDfp',\n    value: function shouldSendRequestToDfp(adSlot$$1) {\n      // Conflict management check\n      return this.conflictResolver.isBlocked(adSlot$$1.id) === false &&\n      // Valid Referrer check\n      adSlot$$1.isWhitelisted() &&\n      // Not in referrer Blacklist\n      adSlot$$1.isBlacklisted() === false && this.shouldDisplayAdAfterAdBlockRemoval(adSlot$$1) &&\n      //  if a paywall pop-up is shown And the number is 12 or more - SHOW MAAVRON\n      this.shouldDisplayAdMaavaronAfterPayWallBanner(adSlot$$1) &&\n      // Responsive: breakpoint contains ad?\n      this.doesBreakpointContainAd(adSlot$$1) &&\n      // check in case of Smartphoneapp\n      this.haveValidCookieForSmartphoneapp() &&\n      // Targeting check (userType vs. slotTargeting)\n      this.doesUserTypeMatchBannerTargeting(adSlot$$1) &&\n      // Impressions Manager check (limits number of impressions per slot)\n      this.user.impressionManager.reachedQuota(adSlot$$1.id) === false;\n    }\n  }, {\n    key: 'shouldDisplayAdAfterAdBlockRemoval',\n    value: function shouldDisplayAdAfterAdBlockRemoval(adSlot$$1) {\n      return !(this.config.adBlockRemoved === true && (adSlot$$1.type === adTypes.maavaron || adSlot$$1.type === adTypes.popunder));\n    }\n  }, {\n    key: 'shouldDisplayAdMaavaronAfterPayWallBanner',\n    value: function shouldDisplayAdMaavaronAfterPayWallBanner(adSlot$$1) {\n      var shouldDisplay = true;\n      if (this.config.site === 'haaretz' && adSlot$$1.type === adTypes.maavaron) {\n        try {\n          var paywallBanner = JSON.parse(window.localStorage.getItem('_cobj'));\n          shouldDisplay = !paywallBanner || paywallBanner.mc && paywallBanner.mc >= 12 || paywallBanner.nextslotLocation && !paywallBanner.nextslotLocation.includes('pop');\n        } catch (err) {\n          /* eslint-disable no-console*/\n          console.error('ERROR ON shouldDisplayAdMaavaronAfterPayWallBanner');\n          /* eslint-enable no-console*/\n        }\n      }\n      return shouldDisplay;\n    }\n\n    /**\n     * Check whether or not an ad slot should appear for the current user type\n     * @param {String} adSlotOrTarget the adSlot to check or the target as a string\n     * @returns {boolean} true iff the slot should appear for the user type\n     */\n\n  }, {\n    key: 'haveValidCookieForSmartphoneapp',\n    value: function haveValidCookieForSmartphoneapp() {\n      return this.config.isValidForsmartPhone;\n    }\n\n    /**\n     * Check whether or not an ad slot should appear for the current user type\n     * @param {String} adSlotOrTarget the adSlot to check or the target as a string\n     * @returns {boolean} true iff the slot should appear for the user type\n     */\n\n  }, {\n    key: 'doesUserTypeMatchBannerTargeting',\n    value: function doesUserTypeMatchBannerTargeting(adSlotOrTarget) {\n      var userType = this.user.type;\n      var adTarget = typeof adSlotOrTarget === 'string' ? adSlotOrTarget : adSlotOrTarget.target;\n\n      switch (adTarget) {\n        case adTargets.all:\n          return true;\n        case adTargets.nonPaying:\n          return userType === userTypes$1.anonymous || userType === userTypes$1.registered;\n        case adTargets.anonymous:\n          return userType === userTypes$1.anonymous;\n        case adTargets.registered:\n          return userType === userTypes$1.registered;\n        case adTargets.paying:\n          return userType === userTypes$1.payer;\n        case adTargets.digitalOnly:\n          return userType === userTypes$1.payer;\n        case adTargets.digitalAndPrint:\n          return userType === userTypes$1.payer;\n        default:\n          return false;\n      }\n    }\n\n    /**\n     * Report to the AdManager that a breakpoint has been switched (passed from one break to\n     * another). Should there be a responsive slot with a\n     * @param {Breakpoint} breakpoint - the breakpoint that is currently being displayed\n     * @returns {Integer} affected - the number of adSlots affected by the change\n     */\n\n  }, {\n    key: 'switchedToBreakpoint',\n    value: function switchedToBreakpoint(breakpoint) {\n      if (!breakpoint) {\n        throw new Error('Missing argument: a call to switchedToBreakpoint must have an breakpoint');\n      }\n      var count = 0;\n      var _iteratorNormalCompletion6 = true;\n      var _didIteratorError6 = false;\n      var _iteratorError6 = undefined;\n\n      try {\n        for (var _iterator6 = this.adSlots.keys()[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n          var adSlotKey = _step6.value;\n\n          var adSlot$$1 = this.adSlots.get(adSlotKey);\n          if (adSlot$$1.responsive === true && adSlot$$1.lastResolvedWithBreakpoint) {\n            if (adSlot$$1.lastResolvedWithBreakpoint !== breakpoint) {\n              adSlot$$1.refresh();\n              count++;\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError6 = true;\n        _iteratorError6 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion6 && _iterator6.return) {\n            _iterator6.return();\n          }\n        } finally {\n          if (_didIteratorError6) {\n            throw _iteratorError6;\n          }\n        }\n      }\n\n      return count;\n    }\n\n    /**\n     * Checks whether an adSlot is defined for a given breakpoint (Default: current breakpoint)\n     * @param {AdSlot} adSlot - the adSlot to check.\n     * @param {Breakpoint} [breakpoint=currentBreakpoint] - the breakpoint to check this ad in.\n     * @returns {boolean} true iff the adSlot is defined for the given breakpoint.\n     */\n\n  }, {\n    key: 'doesBreakpointContainAd',\n    value: function doesBreakpointContainAd(adSlot$$1) {\n      var breakpoint = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getBreakpoint();\n\n      if (!adSlot$$1) {\n        throw new Error('Missing argument: a call to doesBreakpointContainAd must have an adSlot');\n      }\n      var containsBreakpoint = true;\n      if (adSlot$$1.responsive === true) {\n        var mapping = adSlot$$1.responsiveAdSizeMapping[getBreakpointName(breakpoint)];\n        if (Array.isArray(mapping) === false) {\n          throw new Error('Invalid argument: breakpoint:' + breakpoint + ' doesn\\'t exist!', this);\n        }\n        containsBreakpoint = mapping.length > 0 && !arraysEqual(mapping, [[0, 0]]);\n      }\n      return containsBreakpoint;\n    }\n\n    /**\n     * Initializes the callback from the 'slotRenderEnded' event for each slot\n     */\n\n  }, {\n    key: 'initSlotRenderedCallback',\n    value: function initSlotRenderedCallback() {\n      var _this3 = this;\n\n      if (window.googletag && window.googletag.apiReady) {\n        var pubads = window.googletag.pubads();\n        pubads.addEventListener('slotRenderEnded', function (event) {\n          var id = event.slot.getAdUnitPath().split('/')[3];\n          var isEmpty = event.isEmpty;\n          var resolvedSize = event.size;\n          // console.log('slotRenderEnded for slot',id,' called @',window.performance.now());\n          if (_this3.adSlots.has(id)) {\n            var adSlot$$1 = _this3.adSlots.get(id);\n            adSlot$$1.lastResolvedSize = resolvedSize;\n            adSlot$$1.lastResolvedWithBreakpoint = getBreakpoint();\n            if (isEmpty) {\n              adSlot$$1.lastResolvedSize = ConflictResolver.EMPTY_SIZE;\n              adSlot$$1.hide();\n              _this3.releaseSlotDependencies(adSlot$$1);\n            } else {\n              _this3.releaseSlotDependencies(adSlot$$1, adSlot$$1.lastResolvedSize);\n            }\n            _this3.user.impressionManager.registerImpression('' + adSlot$$1.id + _this3.config.department);\n            _this3.user.impressionManager.registerImpression(adSlot$$1.id + '_all');\n          }\n        });\n      } else {\n        throw new Error('googletag api was not ready when \\'initSlotRenderedCallback\\' was called!');\n      }\n    }\n  }, {\n    key: 'releaseSlotDependencies',\n    value: function releaseSlotDependencies(adSlot$$1) {\n      try {\n        var id = adSlot$$1.id;\n        this.conflictResolver.updateResolvedSlot(id, adSlot$$1.lastResolvedSize);\n        if (this.conflictResolver.isBlocking(id)) {\n          // Hide all blocked adSlots\n          var _iteratorNormalCompletion7 = true;\n          var _didIteratorError7 = false;\n          var _iteratorError7 = undefined;\n\n          try {\n            for (var _iterator7 = this.conflictResolver.getBlockedSlotsIds(id)[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n              var blockedSlot = _step7.value;\n\n              if (this.conflictResolver.isBlocked(blockedSlot)) {\n                if (this.adSlots.has(blockedSlot)) {\n                  this.adSlots.get(blockedSlot).hide();\n                }\n              }\n            }\n            // Show the non blocked\n          } catch (err) {\n            _didIteratorError7 = true;\n            _iteratorError7 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion7 && _iterator7.return) {\n                _iterator7.return();\n              }\n            } finally {\n              if (_didIteratorError7) {\n                throw _iteratorError7;\n              }\n            }\n          }\n\n          var _iteratorNormalCompletion8 = true;\n          var _didIteratorError8 = false;\n          var _iteratorError8 = undefined;\n\n          try {\n            for (var _iterator8 = this.conflictResolver.deferredSlots.keys()[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {\n              var deferredSlotKey = _step8.value;\n\n              var deferredAdSlot = this.adSlots.get(deferredSlotKey);\n              if (deferredAdSlot && this.shouldSendRequestToDfp(deferredAdSlot)) {\n                this.conflictResolver.deferredSlots.delete(deferredSlotKey);\n                if (deferredAdSlot.deferredSlot) {\n                  deferredAdSlot.defineSlot();\n                  deferredAdSlot.deferredSlot = false;\n                }\n                deferredAdSlot.show();\n              }\n            }\n          } catch (err) {\n            _didIteratorError8 = true;\n            _iteratorError8 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion8 && _iterator8.return) {\n                _iterator8.return();\n              }\n            } finally {\n              if (_didIteratorError8) {\n                throw _iteratorError8;\n              }\n            }\n          }\n        }\n      } catch (err) {\n        /* eslint-disable no-console*/\n        console.error('Cannot updateSlotDependencies for adSlot: ' + adSlot$$1.id);\n        /* eslint-enable no-console*/\n      }\n    }\n\n    /**\n     * Initializes page-level targeting params.\n     */\n\n  }, {\n    key: 'initGoogleTargetingParams',\n    value: function initGoogleTargetingParams() {\n      if (window.googletag && window.googletag.apiReady) {\n        // Returns a reference to the pubads service.\n        var pubads = googletag.pubads();\n        // Environment targeting (dev, test, prod)\n        if (this.config.environment) {\n          pubads.setTargeting('stg', [this.config.environment]);\n        }\n\n        // User targeting\n        if (this.user.type) {\n          pubads.setTargeting('UserType', [this.user.type]);\n        }\n        if (this.user.htz_type) {\n          pubads.setTargeting('htz_user_type', [this.user.htz_type]);\n        }\n        if (this.user.tm_type) {\n          pubads.setTargeting('tm_user_type', [this.user.tm_type]);\n        }\n        if (this.user.hdc_type) {\n          pubads.setTargeting('hdc_user_type', [this.user.hdc_type]);\n        }\n        if (this.user.age) {\n          pubads.setTargeting('age', [this.user.age]);\n        }\n        if (this.user.gender) {\n          pubads.setTargeting('urgdr', [this.user.gender]);\n        }\n\n        // Context targeting\n        if (this.config.articleId) {\n          pubads.setTargeting('articleId', [this.config.articleId]);\n        }\n        if (this.config.gStatCampaignNumber && this.config.gStatCampaignNumber !== -1) {\n          pubads.setTargeting('gstat_campaign_id', [this.config.gStatCampaignNumber]);\n        }\n        if (this.config.proposalNumber) {\n          pubads.setTargeting('proposaltype', [this.config.proposalNumber]);\n        }\n        if (this.config.isWriterAlerts) {\n          pubads.setTargeting('WriterAlerts', ['true']);\n        }\n        // UTM targeting\n        /* eslint-disable no-underscore-dangle */\n        if (this.config.utm_.content) {\n          pubads.setTargeting('utm_content', [this.config.utm_.content]);\n        }\n        if (this.config.utm_.source) {\n          pubads.setTargeting('utm_source', [this.config.utm_.source]);\n        }\n        if (this.config.utm_.medium) {\n          pubads.setTargeting('utm_medium', [this.config.utm_.medium]);\n        }\n        if (this.config.utm_.campaign) {\n          pubads.setTargeting('utm_campaign', [this.config.utm_.campaign]);\n        }\n        /* eslint-enable no-underscore-dangle */\n        // AdBlock removal\n        if (this.config.adBlockRemoved) {\n          pubads.setTargeting('adblock_removed', [this.config.adBlockRemoved]);\n        }\n        // University targeting - triggered via cookie\n        if (this.config.wifiLocation) {\n          pubads.setTargeting('wifi', [this.config.wifiLocation]);\n        }\n        if (this.config.tags && Array.isArray(this.config.tags)) {\n          pubads.setTargeting('tags', [].concat(_toConsumableArray(this.config.tags)));\n        }\n\n        if (this.user.sso && this.config.ssoGroupKey) {\n          pubads.setTargeting(this.config.ssoGroupKey, this.user.sso);\n        }\n        if (this.config.anonymousId) {\n          var anonymousIdKeyName = 'anonymousIdKey';\n          pubads.setTargeting(anonymousIdKeyName, this.config.anonymousId);\n        }\n        // Ads Centering\n        pubads.setCentering(true);\n      } else {\n        throw new Error('googletag api was not ready when \\'initGoogleTargetingParams\\' was called!');\n      }\n    }\n\n    /**\n     * Initializes googletag services.\n     */\n\n  }, {\n    key: 'initGoogleGlobalSettings',\n    value: function initGoogleGlobalSettings() {\n      if (window.googletag && window.googletag.apiReady) {\n        var googleGlobalSettings = this.config.googleGlobalSettings;\n        // Enable GET parameter overrides\n        if (window.location.search) {\n          var search = window.location.search;\n          if (search.indexOf('sraon') > 0) {\n            console.log('Single Request Mode: active'); // eslint-disable-line no-console\n            googleGlobalSettings.enableSingleRequest = true;\n          } else if (search.indexOf('sraoff') > 0) {\n            console.log('Single Request Mode: disabled'); // eslint-disable-line no-console\n            googleGlobalSettings.enableSingleRequest = false;\n          }\n          if (search.indexOf('asyncrenderingon') > 0) {\n            console.log('Async rendering mode: active'); // eslint-disable-line no-console\n            googleGlobalSettings.enableAsyncRendering = true;\n          } else if (search.indexOf('asyncrenderingonoff') > 0) {\n            console.log('Sync rendering mode: active'); // eslint-disable-line no-console\n            googleGlobalSettings.enableAsyncRendering = false;\n          }\n        }\n        // Google services activation\n        if (googleGlobalSettings.enableSingleRequest === true) {\n          googletag.pubads().enableSingleRequest();\n        }\n        if (googleGlobalSettings.enableAsyncRendering === true) {\n          googletag.pubads().enableAsyncRendering();\n        } else {\n          googletag.pubads().enableSyncRendering();\n        }\n        // Enables all GPT services that have been defined for ad slots on the page.\n        googletag.enableServices();\n      } else {\n        throw new Error('googletag api wasn\\'t ready when \\'initGoogleGlobalSettings\\' was called!');\n      }\n    }\n  }]);\n\n  return AdManager;\n}();\n\nvar defaultConfig = dfpConfig || {};\nvar resizeTimeout = 250;\n\nvar DFP = function () {\n  function DFP(config) {\n    _classCallCheck(this, DFP);\n\n    this.config = Object.assign({}, defaultConfig, config);\n    this.wasInitialized = false;\n    this.initStarted = false;\n    this.breakpoint = getBreakpoint();\n    this.initWindowResizeListener();\n  }\n\n  /**\n   * This part of the object's construction is dependent on the call to 'init'\n   */\n\n  _createClass(DFP, [{\n    key: 'resumeInit',\n    value: function resumeInit() {\n      try {\n        this.adManager = this.adManager || new AdManager(this.config);\n      } catch (err) {\n        console.error(err); // eslint-disable-line no-console\n      }\n    }\n\n    /**\n     * initializes the 'googletag' global namespace and add the\n     * google publish tags library to the page\n     * @returns {Promise} that resolves to true once the googletag api is ready to use\n     * (googletag.apiReady = true)\n     */\n\n  }, {\n    key: 'initGoogleTag',\n    value: function initGoogleTag() {\n      var _this = this;\n\n      var dfpThis = this;\n      return new Promise(function (resolve, reject) {\n        if (dfpThis.initStarted === true) {\n          googletag.cmd.push(function () {\n            dfpThis.wasInitialized = true;\n            resolve(dfpThis);\n          });\n        } else {\n          dfpThis.initStarted = true;\n          // set up a place holder for the gpt code downloaded from google\n          window.googletag = window.googletag || {};\n\n          // this is a command queue used by GPT any methods added to it will be\n          // executed when GPT code is available, if GPT is already available they\n          // will be executed immediately\n          window.googletag.cmd = window.googletag.cmd || [];\n          // load google tag services JavaScript\n          (function () {\n            var tag = window.document.createElement('script');\n            tag.async = true;\n            tag.type = 'text/javascript';\n            // Supports both https and http\n            tag.setAttribute('src', '//www.googletagservices.com/tag/js/gpt.js');\n            var node = window.document.getElementsByTagName('script')[0];\n            tag.addEventListener('load', function () {\n              dfpThis.resumeInit();\n              googletag.cmd.push(function () {\n                dfpThis.wasInitialized = true;\n                resolve(_this);\n              });\n            });\n            tag.addEventListener('error', function (error) {\n              dfpThis.wasInitialized = false;\n              reject(error);\n            });\n            node.parentNode.insertBefore(tag, node);\n          })();\n        }\n      });\n    }\n\n    /**\n     *  Returns true iff googletag was properly initialized on the page\n     * @returns {boolean}\n     */\n\n  }, {\n    key: 'isGoogleTagReady',\n    value: function isGoogleTagReady() {\n      if (this.wasInitialized === true || window.googletag && window.googletag.apiReady) {\n        this.wasInitialized = true;\n      }\n      return this.wasInitialized;\n    }\n\n    /**\n     * Initializes the window resize listener to support responsive ad refreshes\n     */\n\n  }, {\n    key: 'initWindowResizeListener',\n    value: function initWindowResizeListener() {\n      var dfpThis = this;\n      function onResize() {\n        var currentBreakpoint = getBreakpoint();\n        if (dfpThis.breakpoint !== currentBreakpoint) {\n          dfpThis.breakpoint = currentBreakpoint;\n          if (dfpThis.adManager) {\n            dfpThis.adManager.refreshAllSlots();\n          } else {\n            throw new Error('initWindowResizeListener error - adManager instance is not available');\n          }\n        }\n      }\n      var debouncedFunction = debounce(onResize, resizeTimeout);\n      window.onresize = debouncedFunction;\n    }\n  }]);\n\n  return DFP;\n}();\n\n// const pkg = require('./../package.json');\n\n// DFP version is based on the package.json\nDFP.version = version || 'VERSION';\n\n/*\n // Only for development mode\n if ( process.env.NODE_ENV !== 'production' ) {\n DFP.dev = '123';\n }\n */\n\nvar config = dfpConfig;\nvar version$1 = DFP.version;\n\nexport default DFP;\nexport { config, version$1 as version };\n"]}